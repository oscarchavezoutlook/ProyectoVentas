@{
    ViewData["Title"] = "Inicio";
}

<div class="container mt-3">

    <!-- üîπ ACCI√ìN PRINCIPAL -->
    <div class="d-grid mb-4">
        <a asp-controller="Ventas"
           asp-action="Create"
           class="btn btn-primary btn-lg">
            ‚ûï Registrar venta
        </a>
    </div>

    <!-- üîπ RESUMEN DEL D√çA -->
    <div class="row g-3 mb-4">

        <div class="col-6 col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <small class="text-muted">Ganancia hoy</small>
                    <h4 class="text-success">
                        $@ViewBag.GananciaHoy
                    </h4>
                </div>
            </div>
        </div>

        <div class="col-6 col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <small class="text-muted">Meta diaria</small>
                    <h4>
                        $@ViewBag.MetaDiaria
                    </h4>
                </div>
            </div>
        </div>

        <div class="col-6 col-md-3">
            <div class="card text-center shadow-sm">
                <div class="card-body">
                    <small class="text-muted">Falta</small>
                    <h4 class="text-warning">
                        $@ViewBag.FaltaParaMeta
                    </h4>
                </div>
            </div>
        </div>

        <div class="col-6 col-md-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <small class="text-muted d-block text-center">
                        Progreso
                    </small>

                    <div class="progress mt-2" style="height: 20px;">
                        <div class="progress-bar bg-success"
                             style="width: @ViewBag.Progreso%">
                            @ViewBag.Progreso%
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- üîπ VENTAS DE HOY -->
    <div class="card shadow-sm mb-4">
        <div class="card-header">
            <strong>Ventas de hoy</strong>
        </div>

        <div class="card-body p-0">
            @if (ViewBag.VentasHoy == null || ViewBag.VentasHoy.Count == 0)
            {
                <div class="p-3 text-muted text-center">
                    No hay ventas registradas hoy
                </div>
            }
            else
            {
                <div class="table-responsive">
                    <table class="table table-sm mb-0">
                        <thead class="table-light">
                            <tr>
                                <th >Art√≠culo</th>
                                <th>Ganancia</th>
                                <th>Ubicaci√≥n</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var venta in ViewBag.VentasHoy)
                            {
                                <tr>
                                    <td>@venta.Articulo</td>
                                    <td class="text-success">
                                        $@(venta.PrecioVenta - venta.Inversion)
                                    </td>
                                    <td>@venta.Ubicacion</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
        </div>
    </div>

            @* <h4 class="mt-5">Ventas Pendientes</h4> *@



<table class="table table-bordered">
    <thead>
        <tr>
            <th>Art√≠culo</th>
            <th>Cliente</th>
            <th>Ubicaci√≥n</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var p in ViewBag.Pendientes)
        {
            <tr>
                <td>@p.Articulo</td>
                <td>@p.NombreCliente</td>
                <td>@p.Ubicacion</td>
                <td>
                         <form asp-controller="VentasPendientes"
                        asp-action="Delete"
                        method="post"
                        style="display:inline;">
                        <input type="hidden" name="id" value="@p.Id" />
                        <button class="btn btn-sm btn-danger">Eliminar</button>
                        </form>
                </td>
            </tr>
        }
    </tbody>
</table>

<button class="btn btn-warning btn-lg shadow-sm w-100" data-bs-toggle="modal" data-bs-target="#modalPendiente">
   ‚ûï Nueva Venta Pendiente
</button>







    <!-- üîπ ACCESO AL HISTORIAL -->
    <div class="mt-5 pt-4 border-top text-center">
        <a asp-controller="Ventas"
           asp-action="Index"
           class="btn btn-outline-secondary">
            Ver historial completo
        </a>
    </div>

</div>


<!-- 
MODAL DE BOOTSTRAP
- fade: animaci√≥n al abrir/cerrar
- id="modalPendiente": identificador para abrir el modal desde un bot√≥n
- tabindex="-1": evita que se enfoque autom√°ticamente
-->
<div class="modal fade" id="modalPendiente" tabindex="-1">

    <!-- 
    modal-dialog-centered:
    centra el modal verticalmente en la pantalla
    -->
    <div class="modal-dialog modal-dialog-centered">

        <!-- 
        modal-content:
        contenedor principal del modal
        -->
        <div class="modal-content">

            <!-- ================= HEADER ================= -->
            <div class="modal-header">

                <!-- T√≠tulo del modal -->
                <h5 class="modal-title">Venta Pendiente</h5>

                <!-- 
                Bot√≥n X para cerrar el modal
                data-bs-dismiss="modal" es CLAVE para Bootstrap 5
                -->
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>

            </div>

            <!-- ================= FORMULARIO ================= -->
            <!-- 
            asp-controller="VentasPendientes":
            apunta al controlador VentasPendientesController

            asp-action="Create":
            ejecuta el m√©todo Create (POST)

            method="post":
            env√≠a los datos de forma segura
            -->
            <form asp-controller="VentasPendientes" asp-action="Create" method="post">

                <div class="modal-body">

                    <!-- ===== CAMPO ART√çCULO ===== -->
                    <div class="mb-3">
                        <label class="form-label">Art√≠culo</label>

                        <!-- 
                        name="Articulo":
                        DEBE coincidir con la propiedad del modelo o par√°metro del controller
                        -->
                        <input name="Articulo" class="form-control" required />
                    </div>

                    <!-- ===== CAMPO CLIENTE ===== -->
                    <div class="mb-3">
                        <label class="form-label">Cliente</label>

                        <!-- 
                        name="NombreCliente":
                        debe llamarse igual que en el modelo
                        -->
                        <input name="NombreCliente" class="form-control" required />
                    </div>

                    <!-- ===== CAMPO UBICACI√ìN ===== -->
                    <div class="mb-3">
                        <label class="form-label">Ubicaci√≥n</label>

                        <input name="Ubicacion" class="form-control" required />
                    </div>

                </div>

                <!-- ================= FOOTER ================= -->
                <div class="modal-footer">

                    <!-- 
                    type="submit":
                    env√≠a el formulario al controller
                    -->
                    <button type="submit" class="btn btn-success">
                        Guardar
                    </button>

                    <!-- 
                    Cierra el modal sin guardar
                    -->
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        Cancelar
                    </button>

                </div>
            </form>

        </div>
    </div>
</div>