@model ProyectoVentas.Models.Venta

<h1>Editar Venta</h1>

<form asp-action="Edit" method="post">
    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="Id" />

      <div class="mb-3">
             <label class="form-label">Art铆culo</label>
            <select asp-for="Articulo" class="form-select">
                <option value="">Seleccione un art铆culo</option>

                @foreach (var articulo in ViewBag.Articulos)
                {
                    <option value="@articulo">@articulo</option>
                }
            </select>
        </div>
    <div class="mb-3">
        <label class="form-label">Fecha de Venta</label>
        <input asp-for="FechaVenta" type="date" class="form-control" />
    </div>

   <div class="mb-3">
        <label class="form-label">Cuenta Facebook</label>
        <select asp-for="Facebook" class="form-select">
        <option value="">Seleccione cuenta o clon de Facebook</option>

        @foreach (var facebook in ViewBag.Facebooks)
        {
            <option value="@facebook">@facebook</option>
        }
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Precio de Venta</label>
        <input asp-for="PrecioVenta" class="form-control" />
    </div>

    <div class="mb-3">
        <label class="form-label">Inversi贸n</label>
        <input asp-for="Inversion" class="form-control" />
    </div>


<div class="mb-3">
    <label class="form-label">Ubicaci贸n</label>
                @*este apartado fue una verdadera lata*@
    <select asp-for="Ubicacion" class="form-select" id="ubicacionSelect">
        @* Si la ubicaci贸n actual NO est谩 en el cat谩logo, la agregamos *@
        @if (!ViewBag.Ubicaciones.Contains(Model.Ubicacion))
        {
            <option value="@Model.Ubicacion" selected>
                @Model.Ubicacion
            </option>
        }

        @foreach (var u in ViewBag.Ubicaciones)
        {
            <option value="@u">@u</option>
        }
        <option value="OTRA">Otra...</option>
    </select>
     <input type="text"
           id="ubicacionManual"
           class="form-control mt-2 d-none"
           placeholder="Escriba otra ubicaci贸n" />
</div>


    <div class="mb-3">
        <label class="form-label">Cliente</label>
        <input asp-for="Cliente" class="form-control" />
    </div>

    <div class="mb-3">
        <label class="form-label">Comentario</label>
        <textarea asp-for="Comentario" class="form-control"></textarea>
    </div>

    <button type="submit" class="btn btn-primary">Guardar Cambios</button>

    <a asp-action="Index" class="btn btn-secondary">Volver</a>


    <script>
    const selectUbicacion = document.getElementById("ubicacionSelect");
    const inputUbicacion = document.getElementById("ubicacionManual");
    const form = selectUbicacion.closest("form");

    selectUbicacion.addEventListener("change", () => {
        if (selectUbicacion.value === "OTRA") {
            inputUbicacion.classList.remove("d-none");
            inputUbicacion.name = "Ubicacion";
        } else {
            inputUbicacion.classList.add("d-none");
            inputUbicacion.name = "";
        }
    });

    form.addEventListener("submit", () => {
        if (selectUbicacion.value === "OTRA") {
            //  ESTA LNEA ES LA CLAVE FINAL
            selectUbicacion.disabled = true;
        }
    });
</script>


</form>
